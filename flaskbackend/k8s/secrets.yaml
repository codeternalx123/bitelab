# Kubernetes Secrets for Recommendation Serving
# IMPORTANT: This is a template. Replace with actual secrets using sealed-secrets or external secrets operator

apiVersion: v1
kind: Secret
metadata:
  name: recommendation-secrets
  namespace: wellomex
  labels:
    app: recommendation-serving
type: Opaque
stringData:
  # Authentication secret key (CHANGE IN PRODUCTION!)
  auth_secret_key: "CHANGE_ME_IN_PRODUCTION_USE_STRONG_RANDOM_STRING"
  
  # Redis password (if authentication enabled)
  redis_password: "REDIS_PASSWORD_HERE"
  
  # Database credentials (if needed)
  database_url: "postgresql://user:password@host:5432/dbname"
  
  # External API keys
  api_key: "YOUR_API_KEY_HERE"
  
  # TLS certificates (or use cert-manager)
  # tls.crt: |
  #   -----BEGIN CERTIFICATE-----
  #   ...
  #   -----END CERTIFICATE-----
  # tls.key: |
  #   -----BEGIN PRIVATE KEY-----
  #   ...
  #   -----END PRIVATE KEY-----

---
# ServiceAccount for recommendation serving
apiVersion: v1
kind: ServiceAccount
metadata:
  name: recommendation-serving
  namespace: wellomex
  labels:
    app: recommendation-serving

---
# RBAC: Role for recommendation serving
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: recommendation-serving-role
  namespace: wellomex
rules:
- apiGroups: [""]
  resources: ["configmaps", "secrets"]
  verbs: ["get", "list", "watch"]
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get", "list"]

---
# RBAC: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: recommendation-serving-rolebinding
  namespace: wellomex
subjects:
- kind: ServiceAccount
  name: recommendation-serving
  namespace: wellomex
roleRef:
  kind: Role
  name: recommendation-serving-role
  apiGroup: rbac.authorization.k8s.io
